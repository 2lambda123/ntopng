{
    "name" : "ASN",
    "i18n_name" : "top_asn",
    "data_source" : "flows",
    "chart" : [{
        "chart_gui_name" : "Top Destination ASN",
        "chart_name" : "top_srv_asn",
        "chart_type" : "timeseries_area_chart",
        "events" : {
            "dataPointSelection" : "db_analyze"
        },
        "filter" : "srv_asn",
        "value_type" : "bytes",
        "label" : [ "srv_asn" ],
        "params" : {
            "orderby" : "TOTAL_BYTES",
            "count" : "TOTAL_BYTES",
            "groupby" : "DST_ASN",
            "limit" : 10
        },
        "select" : {
            "sql" : "DST_ASN, sum(TOTAL_BYTES) AS bytes"
        },
        "y_formatter" : "format_bytes",
    },
    {
        "chart_gui_name" : "Top Source ASN",
        "chart_name" : "top_cli_asn",
        "chart_type" : "timeseries_area_chart",
        "events" : {
            "dataPointSelection" : "db_analyze"
        },
        "filter" : [ "cli_asn" ],
        "value_type" : "bytes",
        "label" : [ "cli_asn" ],
        "params" : {
            "orderby" : "TOTAL_BYTES",
            "count" : "TOTAL_BYTES",
            "groupby" : "SRC_ASN",
            "limit" : 10
        },
        "select" : {
            "sql" : "SRC_ASN, sum(TOTAL_BYTES) AS bytes"
        },
        "y_formatter" : "format_bytes",
    },
    {
        "chart_gui_name" : "Top Source ASN L7 Proto",
        "chart_name" : "top_cli_asn_l7_proto",
        "chart_type" : "timeseries_area_chart",
        "events" : {
            "dataPointSelection" : "db_analyze"
        },
        "filter" : "l7proto",
        "value_type" : "bytes",
        "label" : [ "l7proto" ],
        "params" : {
            "orderby" : "TOTAL_BYTES",
            "count" : "TOTAL_BYTES",
            "groupby" : "SRC_ASN, L7_PROTO",
            "limit" : 10
        },
        "select" : {
            "sql" : "SRC_ASN, L7_PROTO, sum(TOTAL_BYTES) AS bytes"
        },
        "y_formatter" : "format_bytes",
    },
    {
        "chart_gui_name" : "Top Destination ASN L7 Proto",
        "chart_name" : "top_srv_asn_l7_proto",
        "chart_type" : "timeseries_area_chart",
        "events" : {
            "dataPointSelection" : "db_analyze"
        },
        "filter" : "l7proto",
        "value_type" : "bytes",
        "label" : [ "l7proto" ],
        "params" : {
            "orderby" : "TOTAL_BYTES",
            "count" : "TOTAL_BYTES",
            "groupby" : "DST_ASN, L7_PROTO",
            "limit" : 10
        },
        "select" : {
            "sql" : "DST_ASN, L7_PROTO, sum(TOTAL_BYTES) AS bytes"
        },
        "y_formatter" : "format_bytes",
    },
    {
        "chart_gui_name" : "ASN flows with most Packets",
        "chart_name" : "asn_flows_with_most_pkts",
        "chart_type" : "timeseries_area_chart",
        "events" : {
            "dataPointSelection" : "db_analyze_multiple_values"
        },
        "filter" : [ "cli_asn", "srv_asn" ],
        "formatter_fun" : "packets",
        "label" : [ "cli_asn", "srv_asn" ],
        "params" : {
            "orderby" : "TOTAL_BYTES",
            "count" : "TOTAL_BYTES",
            "limit" : 10
        },
        "select" : {
            "sql" : "histogram(5)(PACKETS+1)"
        },
        "from" : {
            "sql" : "select PACKETS from flows where $WHERE "
        },
        "y_formatter" : "format_pkts",
    },{
        "chart_gui_name" : "Top Source ASN",
        "chart_name" : "top_cli_asn_2",
        "chart_type" : "timeseries_area_chart",
        "events" : {
            "dataPointSelection" : "db_analyze"
        },
        "filter" : [ "cli_asn" ],
        "value_type" : "bytes",
        "label" : [ "cli_asn" ],
        "params" : {
            "orderby" : "TOTAL_BYTES",
            "count" : "TOTAL_BYTES",
            "groupby" : "SRC_ASN",
            "limit" : 10
        },
        "select" : {
            "sql" : "SRC_ASN, sum(TOTAL_BYTES) AS bytes"
        },
        "y_formatter" : "format_bytes",
    },],
    "select" : {
        "items" : [
            {
                "name" : "L7_PROTO"
            },
            {
                "name" : "L7_PROTO_MASTER"
            },
            {
                "name" : "SRC_ASN"
            },
            {
                "name" : "DST_ASN"
            },
            {
                "name" : "PACKETS"
            },
            {
                "name" : "bytes",
                "func" : "SUM",
                "param" : "TOTAL_BYTES",
                "value_type" : "bytes"
            }
        ]
    },
    "filters" : {
        "items" : [
            {
                "name": "IPV4_SRC_ADDR"
            },
            {
                "name": "IPV4_DST_ADDR"
            },
            {
                "name" : "IPV6_SRC_ADDR"
            },
            {
                "name" : "IPV6_DST_ADDR"
            },
            {
                "name" : "SRC_LABEL"
            },
            {
                "name" : "DST_LABEL"
            },
        ]
    },
    "show_in_page" : "analysis",
}
