{
    "i18n_name" : "protocols",
    "data_source" : "flows",
    "chart" : [{
        "chart_id" : "top_l7_categories", // Each id MUST be different
        "chart_i18n_name" : "categories",

        "chart_css_styles" : { // CSS chart styles, optional feature
            "max-height" : "25rem",
            "min-height" : "25rem",
        },
        "chart_endpoint" : "/lua/rest/v2/get/db/charts/top_l7_categories.lua",
        "chart_events" : { // JS Events, optional feature
            "dataPointSelection" : "db_analyze"
        },
        "chart_gui_filter" : "l7cat", // Filter displayed in the GUI
        "chart_sql_query" : "SELECT L7_CATEGORY,SUM(TOTAL_BYTES) AS bytes FROM flows WHERE ($WHERE) GROUP BY L7_CATEGORY ORDER BY bytes DESC",
        "chart_type" : "donut_apex_chart",
        "chart_record_value" : "bytes",
        "chart_record_label" : "L7_CATEGORY",
        "chart_width" : 4, // Chart width, it can be a number between 1 and 12, optional feature
        "chart_y_formatter" : "format_bytes", // JS tooltip event, optional feature
    },
    {
        "chart_id" : "top_l7_proto", // Each id MUST be different
        "chart_i18n_name" : "top_l7_proto",

        "chart_css_styles" : { // CSS chart styles, optional feature
            "max-height" : "25rem",
            "min-height" : "25rem",
        },
        "chart_endpoint" : "/lua/rest/v2/get/db/charts/top_l7_proto.lua",
        "chart_events" : { // JS Events, optional feature
            "dataPointSelection" : "db_analyze"
        },
        "chart_gui_filter" : "l7proto", // Filter displayed in the GUI
        "chart_sql_query" : "SELECT L7_PROTO,SUM(TOTAL_BYTES) AS bytes FROM flows WHERE ($WHERE) GROUP BY L7_PROTO ORDER BY bytes DESC",
        "chart_type" : "donut_apex_chart",
        "chart_record_value" : "bytes",
        "chart_record_label" : "L7_PROTO",
        "chart_width" : 4, // Chart width, it can be a number between 1 and 12, optional feature
        "chart_y_formatter" : "format_bytes", // JS tooltip event, optional feature
    },
    {
        "chart_id" : "top_l4_proto", // Each id MUST be different
        "chart_i18n_name" : "top_l4_proto",

        "chart_css_styles" : { // CSS chart styles, optional feature
            "max-height" : "25rem",
            "min-height" : "25rem",
        },
        "chart_endpoint" : "/lua/rest/v2/get/db/charts/top_l4_proto.lua",
        "chart_events" : { // JS Events, optional feature
            "dataPointSelection" : "db_analyze"
        },
        "chart_gui_filter" : "l4proto", // Filter displayed in the GUI
        "chart_sql_query" : "SELECT PROTOCOL,SUM(TOTAL_BYTES) AS bytes FROM flows WHERE ($WHERE) GROUP BY PROTOCOL ORDER BY bytes DESC",
        "chart_type" : "donut_apex_chart",
        "chart_record_value" : "bytes",
        "chart_record_label" : "PROTOCOL",
        "chart_width" : 4, // Chart width, it can be a number between 1 and 12, optional feature
        "chart_y_formatter" : "format_bytes", // JS tooltip event, optional feature
    },
    {
        "chart_id" : "l7_proto_per_flow", // Each id MUST be different
        "chart_i18n_name" : "l7_proto_per_flow",

        "chart_css_styles" : { // CSS chart styles, optional feature
            "max-height" : "35rem",
            "min-height" : "35rem",
        },
        "chart_endpoint" : "/lua/rest/v2/get/db/charts/l7_proto_per_flow.lua",
        "chart_events" : { // JS Events, optional feature
            "dataPointSelection" : "db_analyze"
        },
        "chart_gui_filter" : "l7proto", // Filter displayed in the GUI
        "chart_sql_query" : "SELECT L7_PROTO,COUNT(*) AS flows FROM flows WHERE ($WHERE) GROUP BY L7_PROTO ORDER BY flows DESC LIMIT 20",
        "chart_type" : "bar_apex_chart",
        "chart_record_value" : "flows",
        "chart_record_label" : "L7_PROTO",
        "chart_width" : 12, // Chart width, it can be a number between 1 and 12, optional feature
        "chart_y_formatter" : "format_value", // JS tooltip event, optional feature
    }
    {
        "chart_id" : "top_cli_per_proto", // Each id MUST be different
        "chart_i18n_name" : "top_cli_per_proto",

        "chart_css_styles" : { // CSS chart styles, optional feature
            "max-height" : "35rem",
            "min-height" : "35rem",
        },
        "chart_endpoint" : "/lua/rest/v2/get/db/charts/top_cli_per_proto.lua",
        "chart_events" : { // JS Events, optional feature
            "dataPointSelection" : "db_analyze"
        },
        "chart_gui_filter" : "cli_ip", // Filter displayed in the GUI
        "chart_sql_query" : "SELECT IPv4NumToString(IPV4_SRC_ADDR) AS IPV4_SRC_ADDR_FORMATTED,SRC_LABEL,L7_PROTO,COUNT(*) AS flows FROM flows WHERE ($WHERE) GROUP BY L7_PROTO,IPV4_SRC_ADDR_FORMATTED,SRC_LABEL ORDER BY flows DESC LIMIT 20",
        "chart_type" : "bar_apex_chart",
        "horizontal_chart" : false,
        "chart_record_value" : "flows",
        "chart_record_label" : "IPV4_SRC_ADDR",
        "chart_width" : 12, // Chart width, it can be a number between 1 and 12, optional feature
        "chart_y_formatter" : "format_value", // JS tooltip event, optional feature
    }],
    "show_in_page" : "analysis",
}
